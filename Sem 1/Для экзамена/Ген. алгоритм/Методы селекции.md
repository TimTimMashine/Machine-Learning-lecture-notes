Методы селекции: пропорционально качеству, stochastic universal sampling, с наследием, турнирная, элитизм.

#Элитизм #Турнир #Рулетка #SUS #Наследие

Основная идея в том что мы стараемся выбирать особи с лучшем fitness (приспособленностью) чаще 

План: 
1. Элитизм (плюсы, минусы)
2. Элитизм + случайность (плюсы по сравнению с элитизмом)
3. Рулетка (недостаток, как исправить?)
4. Турнир(без вероятностей, с вероятностями, недостаток)
5. Stochastic Universal Sampling (шаги по прямой с интервалом преимущество по сравнению с рулеткой)
6. Селекция с наследием (принцип наследия, для чего, типичная проблема, типичное решение)
# 1. Элитизм

## Идея
Отсортировали популяцию по убыванию fitness, выбрали с начала $m$ особей

## Подробное описание
Элитизм — это метод, при котором лучшие особи (хромосомы) из текущего поколения сохраняются и передаются в следующее поколение без изменений. Он гарантирует, что наибольшее приспособление не потеряется, даже если кроссовер и мутация случайным образом ухудшат решение.

## Преимущества
- Гарантированно не потеряем особей с хорошим fitness

## Недостатки
- Можем скатиться в локальный минимум
- Можем потерять особь с хорошими участками генов, но малым общим значением fitness (и соответственно )

#### Аналогия с биологией
Инбридинг - близкородственное скрещивание в биологии приводит к нежелательным последствиям.

![[Pasted image 20250104170136.png]]

# 2. Элитизм + случайность
Выбираем $p$ лучших и $1-p$ случайных из оставшихся, $p\in[0,1]$ 

# 3. Рулетка (Roulette Wheel Selection). Ранговая селекция

Метод рулетки выбирает особи пропорционально их приспособленности. Каждый индивид имеет вероятность быть выбранным, которая прямо-пропорциональна его приспособленности.

$$p_{i}= \dfrac{f_i}{\sum\limits_{j=1}^{n} f_{j}}~-~\text{вероятность в очередном раунде рулетки выбрать $i$-тую особь}$$

После пересчитываем сумму и вероятности

![[Pasted image 20250104172902.png]]

![[Pasted image 20250104172932.png]]

Пояснение к выбору

![[Pasted image 20250104172719.png]]

Попытка формулами тоже самое показать

![[Pasted image 20250104173032.png]]

## А как программно реализовать выбор не пересчитывая вероятности и без повторов?

# 4. Турнирный отбор (Tournament Selection)

**Турнирный отбор** — это метод выбора особей из популяции для создания нового поколения. В этом методе несколько случайных особей выбираются для участия в "турнире". Победитель турнира выбирается для дальнейшего использования в алгоритме (например, для кроссовера или мутации).
#### Шаги алгоритма:

1. **Выбор случайных особей**: Сначала случайным образом выбирается несколько особей из популяции. Размер турнира k может быть задан заранее (например, 2, 3, 10 особей).
    
2. **Определение победителя**: Среди выбранных особей определяется победитель, то есть особь с наибольшей функцией приспособленности. Однако в классическом турнирном отборе победитель не всегда выбирается с полной гарантией, а с вероятностью
    ##### Как на паре
    - Сортируем выбранные по убыванию фитнеса
    - С вероятностью 0,9 выбираем особь с самым большим фитнесом или всегда побеждает просто особь с наибольшей приспособленностью
    -  Выбираем дальше пока не выберем 
    ##### Описание от ГПТ-шки

    - Если особь имеет высокую приспособленность, её вероятность победы выше.
    - Особи с низкой приспособленностью могут также иметь шанс быть выбранными, но этот шанс будет меньше.
-  
      
3. **Передача в следующее поколение**: Победившая особь или несколько победителей (в зависимости от настройки) выбираются для формирования нового поколения, используя, например, кроссовер или мутацию.
    
4. **Повторение**: Этот процесс повторяется до тех пор, пока не будут отобраны все особи для следующего поколения.

![[Pasted image 20250104170732.png]]

![[Pasted image 20250104170804.png]]

## Недостатки метода (случай, когда победа просто по приспособленности)
1. Лучшая особь может просто не попасть ни в один из турниров 
   (**Как исправить?** Сделать элитизм (отбор лучших) + турнир, чтобы гарантировать сохранность лучших особей) и добавить турнир )
# 5. Stochastic Universal Sampling (SUS)

**Stochastic Universal Sampling (SUS)** — это метод отбора в генетических алгоритмах, который был предложен как улучшение метода рулетки (roulette wheel selection). Он решает проблему дискретности и неопределенности при использовании метода рулетки, когда случайные числа генерируются для выбора индивидов. SUS позволяет выбрать особи более равномерно и надежно.

## Преимущество по сравнению с рулеткой
Позволяет более равномерно выбирать лучших, средних и плохих

## Описание работы

![[Pasted image 20250104180312.png]]

![[Pasted image 20250104180333.png]]

Пример 

$$\displaylines{
f_{1}= 10\\
f_{2}= 20\\
f_{3}= 30\\
f_{4}= 40\\\\

\text{Мы хотим выбрать 2 особи}\\\\

\text{1. Суммируем приспособленности}\\\\
F = 10+ 20+30 +40 = 100 \\\\
\text{2. Вычисляем размер шага}\\\\
S = \dfrac{F}{2} = \dfrac{100}{2} = 50 \\\\
\text{3. Выбираем начальное значение для старта $S_0\in [0,S]$}\\\\

\text{4. Выбираем первую особь правый конец которой больше либо равен $S_0$, }\\
\text{ в нашем примере $S_{0}= 35$ и мы берём особь номер 1}\\\\


\text{5. Рассчитываем новое значение по формуле: $S_{0}+S$, в нашем примере  }\\
\text{ это будет значение $35+50=85$, первое значение больше либо равное чем 85 - 90, }\\
\text{соответственно берём особь номер 3  }\\



}$$
Особи отсортированы по фитнесу(это необходимо, вроде бы, да, а, вроде бы, нет), чем больше фитнесс, тем длиннее особь. 

Если метка указывает на одну и ту же особь несколько раз, то ничего страшного, будут дубликаты.

![[Pasted image 20250520171849.png]]
Выбираем какое-то значение $S_0$ от 0 до $interval$ (50) 
![[Pasted image 20250520172054.png]]
![[Pasted image 20250521103402.png]]

![[Pasted image 20250520171400.png]]
![[Pasted image 20250104180354.png]]

# 6. Селекция с наследием (Elitism Selection)

## Описание с пары
Если у родителей текущей особи был хороший fitness, то, наверное, она несёт в себе хорошие признаки, но они могли не проявиться после скрещивания хороших родителей, поэтому давайте на всякий случай сохраним их.

$$\displaylines{
\tilde{f} = f_{c} + \alpha \cdot f_p\\

\tilde{f} - \text{новая целевая функция с учетом наследования}\\
f_{c} - \text{реальный фитнесс нашей особи}\\
f_{p} - \text{целевая функия родителей (наследство)}\\
\alpha - \text{коофициент наследования от $0$ до $1$}\\
}$$

Селекция с наследием — это метод, когда **наследуются не только лучшие особи**, но и **передаются все лучшие качества** особей из поколения в поколение. Например, если алгоритм реализует селекцию с наследием, то не только топ-N особей, но и их **потомки** в следующем поколении могут иметь те же качества.

- **Принцип**: Сохраняются лучшие особи на протяжении нескольких поколений.
- **Цель**: Повторно использовать лучшие характеристики особей, чтобы обеспечить стабильность и улучшение популяции.
- **Применение**: Используется, если необходимо сохранить генетическое разнообразие и характеристики, которые могут передаваться потомкам.

 **Основные различия**:

- **Элитизм** чаще всего подразумевает **перенос лучших особей в следующее поколение**, чтобы гарантировать их сохранение.
- **Селекция с наследием** может быть более **долгосрочной** и включать в себя механизм наследования **качеств особей**, а не только их прямое сохранение.

Но в повседневной практике термины **элементы элитизма** и **селекция с наследием** иногда могут перекрываться, и в разных источниках их могут рассматривать как схожие или даже идентичные методы, особенно когда речь идет о сохранении лучших решений.

Таким образом, несмотря на схожесть, их можно различать по акценту на сохранении как отдельных особей, так и **генетических характеристик** в целом.

